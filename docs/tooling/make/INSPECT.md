<!-- markdownlint-disable-file MD060 -->
<!-- markdownlint-disable-file MD024 -->

# ðŸ” Makefile Inspection (`inspect-mk`)

This document explains the **Makefile inspection tooling** provided by the
`inspect-mk` command and the scripts under `scripts/inspect/`.

The goal is **discoverability**, **navigation**, and **read-only introspection**
of the decade-based Makefile architecture.

---

## ðŸ§± What problem this solves

As the Makefile system grows, it becomes harder to answer questions like:

- *What Make targets exist?*
- *Which decade does this file belong to?*
- *Where should I add a new target?*
- *What does `make 70-runtime.mk` actually expose?*

`inspect-mk` exists to answer those questions **without opening files** and
**without executing any side effects**.

---

## ðŸ§­ Decade-based architecture (quick recap)

This repository uses a **numeric decade convention** for Make modules:

| Decade | Purpose |
|------|--------|
| 00s | Kernel / Make bootstrapping |
| 10s | Presentation (UX, colors, formatting) |
| 20s | Configuration & feature flags |
| 30s | Public interface (help, categories, roles) |
| 40s | Preconditions & environment checks |
| 50s | Libraries & shared helpers |
| 60s | Verification & quality gates |
| 70s | Runtime orchestration |
| 80s | Simulation / automation |
| 90s | Delivery / release |

`inspect-mk` uses the **first digit** of the filename to determine the decade
(e.g. `52-commit.mk` â†’ **50s**).

---

## ðŸ› ï¸ Available commands

### List all Make modules (grouped by decade)

```bash
make inspect-mk
```

Example output:

```text
ðŸ“‚ Available make/ modules

50s â€” Library
  ðŸ§© 50-library.mk
  ðŸ§© 52-commit.mk
  ðŸ§© 53-local-hygiene.mk
```

- Read-only
- Grouped by decade
- Emoji indicates the architectural layer

---

### Inspect a single Make module

```bash
make inspect-mk 50
```

or explicitly:

```bash
make inspect-mk FILE=make/50-library.mk
```

This prints all **documented targets** (`##` comments) in that file.

---

### Inspect all modules in a decade

```bash
make inspect-mk 5 FLAG=a
```

or:

```bash
make inspect-mk 50 FLAG=a
```

This inspects **every file in the same decade bucket** and prints:

- A consolidated list of targets
- One header per file

---

## ðŸš« What `inspect-mk` will *not* do

By design, `inspect-mk` is intentionally limited:

- âŒ No execution of targets
- âŒ No mutation of files
- âŒ No environment checks
- âŒ No shelling out to Docker / Gradle / Git

It is **safe to run at any time**.

---

## ðŸ“ Script layout

All logic lives in shell scripts; Make only orchestrates.

```text
scripts/inspect/
â”œâ”€â”€ inspect-router.sh      # main entrypoint (argument routing)
â”œâ”€â”€ inspect-list.sh        # list modules (grouped by decade)
â”œâ”€â”€ inspect-all.sh         # inspect all modules
â”œâ”€â”€ inspect-decade-all.sh  # inspect all modules in one decade
```

This keeps Makefiles:

- thin
- readable
- declarative

---

## ðŸ§  Design principles

- **Discoverability first**
- **Make = orchestration**
- **Scripts = logic**
- **Read-only by default**
- **Boring > clever**

If something feels surprising, itâ€™s probably a bug.

---

## âœ… When to use `inspect-mk`

Use this tool when you want to:

- onboard a new contributor
- understand where a target lives
- audit available commands
- decide which decade a change belongs to
- explore the Makefile system safely

---

If youâ€™re unsure where to add something, start with:

```bash
make inspect-mk
```

and follow the decade. ðŸ§­
